# Constructing Similarity Graph for Spectral Clustering

This code is set up to reproduce the results obtained in my dissertation project _Constructing Similarity Graphs for Spectral Clustering_, submitted in fulfillment of the requirements for the degree of MSc in Artificial Intelligence. This project was supervised by Dr. Peter Macgregor. 


## How to Run Experiments

First run the following from the main directory to install the dependencies of this project: 

```bash
pip install -r requirements.txt
```

Then run the following to execute all experiments.

```bash
python runAllExperiments.py
```

## System Requirements

Please note that systems will less than 32GB of RAM will most likely be unable to run the full set of experiments. 


## Running only one experiment
The following command can be used in order to run just one experiment. 

```bash
python experiments.py {dataset} {similaritygrahp}{bsds_image_id}
```

The possible options for ``{dataset}`` are: 
- bsds
- mnist


The value of ``{similaritygraph}`` can be any of the following: 
- fcn-rbf-{variance}
- fcn-lpl-{variance}
- fcn-inv
- knn{valueofk}
- sparsifier-clus-{gamma}
- sparsifier-spec-{kernelval}-{epsilon}


If the chosen dataset is MNIST, results will be generated by this command under `results/mnist/csv_results/`. If instead the chosen dataset is BSDS, results can be generated with the following: 


```bash 
python analyseBSDSexperiments.py {experimentname}
```

where ``{experimentname}`` is the name that will be used for the results directory and csv file.




## References 
The code in this repository is based on https://github.com/pmacg/spectral-clustering-meta-graphs, the code to reproduce the results in the paper "[A Tighter Analysis of Spectral Clustering, and Beyond](https://arxiv.org/abs/2208.01724)", published in ICML 2022.

```bibtex
@InProceedings{pmlr-v162-macgregor22a,
  title = 	 {A Tighter Analysis of Spectral Clustering, and Beyond},
  author =       {Macgregor, Peter and Sun, He},
  booktitle = 	 {Proceedings of the 39th International Conference on Machine Learning},
  pages = 	 {14717--14742},
  year = 	 {2022},
  volume = 	 {162},
  publisher =    {PMLR},
}
```

